{% comment %}
  This section is used to create a product gallery with a top image and multiple images in a scrollable box.
  The images are responsive and adapt to different screen sizes.
{% endcomment %}
<img
    src="{{ section.settings.top_image | img_url: '608x' }}"
    loading="lazy"
    width="608"
    height="400"
    alt="{{ section.settings.top_image.alt | escape }}"
    srcset="
      {{ section.settings.top_image | img_url: '500x' }} 500w,
      {{ section.settings.top_image | img_url: '608x' }} 608w
    "
    sizes="(max-width: 608px) 100vw, 608px"
    class="img-top"
  />
  
  <div class="image-box">
    {% for block in section.blocks %}
      <img
        src="{{ block.settings.image | img_url: '608x' }}"
        loading="lazy"
        width="auto"
        height="auto"
        alt="{{ block.settings.image.alt | escape }}"
        
        class="img img-h"
      />
    {% endfor %}
  </div>
  
  <div class="indicators-2">
    <div class="dot-17"></div>
  </div>
  
  <div class="contents-2">
    <div class="card-content-3">
      <div class="sec-headline">
        {{ section.settings.headline }}
      </div>
      <div class="sec-subtext">
        {{ section.settings.subtext }}
      </div>
    </div>
  </div>
<style>
  .image-box {
    
  scrollbar-width: none;    /* Firefox */
  -ms-overflow-style: none; /* Internet Explorer 10+ */
}

.image-box::-webkit-scrollbar {
  display: none;            /* Chrome, Safari, and Edge */
}
.image-box.dragging {
  cursor: grabbing;
  cursor: -webkit-grabbing;
}
.image-box {
  cursor: grab;
  cursor: -webkit-grab;
}



  

 
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const imageBox = document.querySelector('.image-box');
  if (!imageBox) return;

  // Clone images for seamless infinite scroll
  const images = imageBox.querySelectorAll('.img.img-h');
  images.forEach(img => {
    const clone = img.cloneNode(true);
    imageBox.appendChild(clone);
  });

  // Set basic styles for horizontal layout
  imageBox.style.display = 'flex';
  imageBox.style.overflow = 'hidden';
  imageBox.style.whiteSpace = 'nowrap';
  imageBox.style.gap = '15px';

  const scrollSpeed = {{ section.settings.scroll_speed | default: 1 }};
  let scrollPosition = 0;
  let animationId;
  let isHovering = false;

  function animateScroll() {
    if (isHovering) {
      animationId = requestAnimationFrame(animateScroll);
      return;
    }

    scrollPosition += scrollSpeed;
    if (scrollPosition >= imageBox.scrollWidth / 2) {
      scrollPosition = 0;
    }

    imageBox.scrollLeft = scrollPosition;
    animationId = requestAnimationFrame(animateScroll);
  }

  imageBox.addEventListener('mouseenter', () => isHovering = true);
  imageBox.addEventListener('mouseleave', () => isHovering = false);

  // ðŸ–±ï¸ Enable horizontal scroll with mouse wheel
  imageBox.addEventListener('wheel', function(e) {
    if (e.deltaY === 0) return;
    e.preventDefault();
    imageBox.scrollLeft += e.deltaY;
    scrollPosition = imageBox.scrollLeft;
  }, { passive: false });

  // ðŸ– Touch support for mobile + ðŸ’» touchpad scroll
  let isTouching = false;
  let startX = 0;
  let scrollLeftStart = 0;

  imageBox.addEventListener('touchstart', (e) => {
    isTouching = true;
    startX = e.touches[0].pageX;
    scrollLeftStart = imageBox.scrollLeft;
  });

  imageBox.addEventListener('touchmove', (e) => {
    if (!isTouching) return;
    const x = e.touches[0].pageX;
    const walk = (startX - x);
    imageBox.scrollLeft = scrollLeftStart + walk;
    scrollPosition = imageBox.scrollLeft;
  });

  imageBox.addEventListener('touchend', () => {
    isTouching = false;
  });

  animateScroll();

  // Clean up
  document.addEventListener('shopify:section:unload', function() {
    cancelAnimationFrame(animationId);
  });
{% comment %} }); {% endcomment %}
</script>




{% schema %}
{
  "name": "Product Gallery",
  "tag": "section",
  "class": "product-gallery ",
  "settings": [
    {
      "type": "image_picker",
      "id": "top_image",
      "label": "Top Image"
    },
    {
      "type": "text",
      "id": "headline",
      "label": "Headline",
      "default": "Seamless Integration into Your Daily Life"
    },
    {
      "type": "textarea",
      "id": "subtext",
      "label": "Subtext",
      "default": "Meet the next generation of eyewear. More than just a pair of glasses, these Smart Glasses are your personal assistant, music hub, and AR navigatorâ€”all in one sleek design."
    },
    {
      "type": "range",
      "id": "scroll_speed",
      "min": 0.1,
      "max": 5,
      "step": 0.1,
      "label": "Scroll Speed",
      "default": 1,
      "info": "Adjust the scrolling speed (lower = slower)"
    }
  ],
  "blocks": [
    {
      "type": "gallery_image",
      "name": "Gallery Image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Product Gallery",
      "category": "Custom",
      "blocks": [
        {
          "type": "gallery_image"
        },
        {
          "type": "gallery_image"
        },
        {
          "type": "gallery_image"
        }
      ]
    }
  ]
}
{% endschema %}